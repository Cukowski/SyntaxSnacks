{% extends 'base.html' %}{% block content %}
<div class="glass">
  <h2>Welcome, {{ current_user.username }}!</h2>
  <div class="stats" style="margin:8px 0 16px">
    <div class="stat">üî• Streak: <strong>{{ current_user.streak }}</strong></div>
    <div class="stat">‚≠ê XP: <strong>{{ current_user.xp }}</strong></div>
  </div>
  {% if challenge %}
    <h3>Today's Snack: {{ challenge.title }}</h3>
    <p style="white-space: pre-wrap">{{ challenge.prompt }}</p>
    <div class="glass" id="runner">
      <h3>Try your solution</h3>
      <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center">
        <label>Language</label>
        <select id="lang">
          <option value="js">JavaScript</option>
          <option value="py">Python</option>
        </select>
        <button class="btn-primary" id="runBtn">Run</button>
      </div>
      <textarea id="code" rows="10" placeholder="// write a function solve(input) { ... }"></textarea>
      <pre id="output" class="card" style="min-height:100px; margin-top:10px;"></pre>
    </div>
    {% if challenge.hints %}
      <button onclick="toggle('hint')" class="ghost">Show Hint</button>
      <div id="hint" style="display:none;margin-top:10px" class="card"><strong>Hint:</strong><br>{{ challenge.hints }}</div>
    {% endif %}
    {% if challenge.solution %}
      <button onclick="toggle('solution')" class="ghost" style="margin-left:6px">Reveal Solution</button>
      <div id="solution" style="display:none;margin-top:10px" class="card"><strong>Solution:</strong><pre style="white-space: pre-wrap">{{ challenge.solution }}</pre></div>
    {% endif %}
    <form method="post" action="{{ url_for('submit_challenge', challenge_id=challenge.id) }}" style="margin-top:12px">
      <button type="submit" class="btn-primary">Mark as Solved (+10 XP)</button>
    </form>
  {% else %}
    <p>No more challenges for now. Check back soon!</p>
  {% endif %}
  {% if joke %}<div class="card joke" style="margin-top:14px">üí° {{ joke }}</div>{% endif %}
</div>
{% endblock %}

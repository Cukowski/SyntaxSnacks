:root { --accent: #00e0b8; }

* { box-sizing: border-box; }

body{
  font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  background: radial-gradient(1200px 800px at 70% 80%, #7b4fff33, #001428 60%);
  color:#ecf3f7; margin:0;
}

/* ===== Navbar ===== */

.navbar{
  position: sticky; top:0;
  z-index: 3000; /* above any content cards */
  backdrop-filter: saturate(140%) blur(8px);
  -webkit-backdrop-filter: saturate(140%) blur(8px);
  background: rgba(10,14,23,.55);
  border-bottom: 1px solid rgba(255,255,255,.06);
}
.navbar .nav-inner{
  max-width:1100px; margin:0 auto;
  padding:10px 16px;
  display:grid; grid-template-columns:auto 1fr auto;
  align-items:center; gap:12px;
}

.brand-link{ display:inline-flex; gap:10px; align-items:center; text-decoration:none; }
.logo{ width:26px; height:26px; }
.brand-link span{ font-weight:700; color:#dffdf6; letter-spacing:.2px; }

/* Links row */
.links{ display:flex; gap:14px; align-items:center; justify-content:flex-end; }
.links a{
  padding:8px 10px; border-radius:10px;
  color:#e8f3ff; text-decoration:none; line-height:1; white-space:nowrap;
}
.links a.active{ background:rgba(90,247,200,.18); color:#b8fff0; }
.links .btn-primary{ padding:8px 14px; }

/* Hamburger (hidden on desktop) */
.menu-toggle{
  display:none; width:40px; height:34px;
  border:1px solid rgba(255,255,255,.15);
  background:rgba(255,255,255,.06); border-radius:10px;
  cursor:pointer; place-items:center;
}
.menu-toggle span{
  display:block; height:2px; width:20px; background:#e8f3ff;
  margin:4px auto; border-radius:2px;
}

/* Buttons */
.btn-primary, button[type="submit"], .btn {
  background: linear-gradient(180deg, #45f0c8, #1bbf9f);
  color: #0b1b2b;
  border: 1px solid rgba(0,0,0,.15);
  padding: 10px 14px;
  border-radius: 12px;
  font-weight: 700;
  box-shadow: 0 6px 20px rgba(0,0,0,.25);
  transition: transform .05s ease, filter .15s ease;
}
.btn-primary:hover, button[type="submit"]:hover, .btn:hover { filter: brightness(1.05); }
.btn-primary:active, button[type="submit"]:active, .btn:active { transform: translateY(1px); }

button, .btn, .btn-primary {
  cursor: pointer;
}
button:disabled, .btn:disabled, .btn-primary:disabled {
  cursor: not-allowed;
  opacity: 0.6;
}

/* Secondary ghost buttons (e.g., Reveal/Hint toggles) */
button.ghost {
  background: rgba(255,255,255,.08);
  color: #e8f3ff;
  border: 1px solid rgba(255,255,255,.2);
  padding: 8px 12px;
  border-radius: 10px;
}

/* Code runner */
#runner .runner-toolbar{
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  align-items: center;
}
#runner .runner-toolbar label{
  font-weight: 600;
  color: #c9ddf1;
}
#runner .runner-toolbar select{
  background: #101622;
  color: #d6e6ff;
  border: 1px solid rgba(255,255,255,.2);
  border-radius: 10px;
  padding: 6px 10px;
}
#runner .runner-grid{
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 12px;
  margin-top: 10px;
}
#runner .runner-panel label,
#runner .runner-output-label{
  display: block;
  margin: 10px 0 6px;
  color: #c9ddf1;
  font-weight: 600;
}
#runner textarea#input{
  width: 100%;
  border-radius: 12px;
  background: #101622;
  color: #d6e6ff;
  border: 1px solid rgba(255,255,255,.14);
  padding: 12px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
}
#runner textarea#code{
  width: 100%;
  border-radius: 12px;
  background: #101622;
  color: #d6e6ff;
  border: 1px solid rgba(255,255,255,.14);
  padding: 12px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
}
#runner pre#output.card{
  background: #0e1420;
  color: #d9f0ff;
  border: 1px solid rgba(255,255,255,.12);
  border-radius: 12px;
  overflow:auto;
}
#runner .ok { border-left: 4px solid #2bd39a; }
#runner .err { border-left: 4px solid #ff6b6b; }
#runner .runner-note{
  color: #9ab3c7;
  margin-top: var(--space-1);
  font-size: 0.9rem;
}
@media (max-width: 720px){
  #runner .runner-grid{
    grid-template-columns: 1fr;
  }
}
pre.code-block{
  background: #0e1420;
  color: #d9f0ff;
  border: 1px solid rgba(255,255,255,.12);
  border-radius: 12px;
  padding: 12px;
  white-space: pre-wrap;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
}

/* ===== Layout ===== */

.container{ max-width:980px; margin:16px auto; padding:14px 14px 0; }

.glass{
  background: linear-gradient(180deg, rgba(255,255,255,.20), rgba(255,255,255,.08));
  border:1px solid rgba(255,255,255,.20);
  border-radius:16px;
  padding: clamp(16px, 2vw + 8px, 28px);
  box-shadow:0 10px 40px rgba(0,0,0,.25);
  transition: background-color .25s ease, border-color .25s ease, box-shadow .25s ease;
  /* z-index removed so it doesn't cover the navbar */
}
.glass:hover{
  transform: none;
  background: linear-gradient(180deg, rgba(255,255,255,.20), rgba(255,255,255,.08));
  box-shadow:0 10px 40px rgba(0,0,0,.25);
}

.puzzle-shell{
  display:flex;
  flex-direction:column;
  gap: clamp(12px, 1.5vw + 8px, 22px);
}

.puzzle-shell h2{ margin:0; }
.puzzle-shell p{ margin:0; }
footer{ color:#a8c0cf; padding:18px; }

/* ===== Components ===== */

.stats{ display:flex; gap:8px; flex-wrap:wrap; }
.stat{ background:rgba(255,255,255,.1); border:1px solid rgba(255,255,255,.15);
  padding:6px 10px; border-radius:10px; }

.table{ width:100%; border-collapse:collapse; }
.table th,.table td{ padding:8px 10px; border-bottom:1px solid rgba(255,255,255,.12); }
.table-responsive{ overflow-x:auto; max-width:100%; }
.table .user-email{
  width:clamp(140px, 22vw, 260px);
  max-width:260px;
}
.table .user-email .truncate{
  display:inline-block;
  max-width:260px;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
  vertical-align:bottom;
}

.flash{
  background:#27c082; color:#0b1b2b;
  padding:10px 12px; border-radius:8px; margin:6px 0;
  font-weight:600; text-align:center;
}

.admin-menu { position: relative; display:inline-block; }
.admin-menu__panel { position:absolute; right:0; background:#111; border:1px solid #333; border-radius:8px; padding:8px 0; display:none; min-width:180px; z-index:20; }
.admin-menu__panel a { display:block; padding:8px 12px; color:#fff; text-decoration:none; }
.admin-menu__panel a:hover { background:#1f1f1f; }
.admin-menu.open .admin-menu__panel { display:block; }

label{ display:block; margin-top:10px; color:#cfe5f4; }
input, textarea{
  width:100%; border-radius:10px;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(0,0,0,.15); color:#e8f4fb; padding:10px;
}

button, .btn-primary{ cursor:pointer; border:none; text-decoration:none !important; }

.hero img{ width:100%; border-radius:16px; opacity:.85; }

.card{
  background:rgba(255,255,255,.12);
  border:1px solid rgba(255,255,255,.18);
  border-radius:12px; padding:8px 10px;
}

/* Public fun/joke card */
.fun-card, .card.joke{
  background:rgba(255,255,255,.85);
  color:#0b1b2b;
  border:1px solid rgba(0,0,0,.08);
  border-left:4px solid var(--accent);
  border-radius:12px; padding:12px 14px;
}

/* Utility */
a{ color:#7ee6d5; } a:hover{ text-decoration:underline; }

/* ===== Vertical rhythm (simple spacing scale) ===== */
:root{
  --space-1: 8px;
  --space-2: 12px;
  --space-3: 16px;
  --space-4: 20px;
  --space-5: 28px;
}

/* Add space between siblings inside any .glass card */
.glass > * + * { margin-top: var(--space-3); }

/* Space between top-level cards on a page */
.container > .glass + .glass { margin-top: var(--space-5); }

/* Space between stacked .card blocks (hint/solution/output, etc.) */
.card + .card { margin-top: var(--space-2); }

/* Runner area: make controls/editors not touch */
#runner h3 { margin-bottom: var(--space-2); }
#runner > div:first-of-type { margin-bottom: var(--space-2); } /* control row */
#runner textarea#code { margin-top: var(--space-2); }
#runner pre#output { margin-top: var(--space-2); }

/* Buttons row spacing (Show Hint / Reveal Solution) */
button + button { margin-left: var(--space-2); }

/* Give the big CTA some air above */
form[action*="submit_challenge"] { margin-top: var(--space-3); }

/* Optional: a generic vertical stack helper you can wrap things with */
.vstack { display: flex; flex-direction: column; gap: var(--space-3); }

/* ===== Responsive ===== */

@media (max-width: 860px){
  .navbar .nav-inner{ grid-template-columns:auto auto; }
  .menu-toggle{ display:grid; }              /* show hamburger */
  .links{
    display:none; grid-column:1 / -1;
    flex-direction:column; align-items:stretch;
    gap:8px; margin-top:8px; padding:10px;
    background:rgba(16,22,33,.7);
    border:1px solid rgba(255,255,255,.06);
    border-radius:14px;
  }
  .links.open{ display:flex; }
  .links a, .links .btn-primary{
    padding:12px 14px; text-align:left; width:100%;
  }
}

/* ===== Dungeon Map Styles ===== */
.dungeon-map {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.dungeon-island {
  border-radius: 16px;
  border: 1px solid rgba(255, 255, 255, .2);
  background: linear-gradient(160deg, rgba(255,255,255,.15), rgba(255,255,255,.05));
  box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  overflow: hidden; /* Ensures content respects border-radius */
}

.dungeon-island:hover {
  transform: translateY(-5px);
  box-shadow: 0 12px 40px 0 rgba(0, 0, 0, 0.4);
}

.dungeon-island .island-link {
  display: block;
  padding: 16px;
  text-decoration: none;
  color: inherit;
}

.dungeon-island h4 { margin: 0 0 8px; color: #fff; }
.dungeon-island p { margin: 0 0 16px; font-size: 0.9em; opacity: 0.8; }

.progress-bar {
  width: 100%;
  height: 24px;
  background-color: rgba(0, 0, 0, 0.3);
  border-radius: 12px;
  position: relative;
  overflow: hidden;
}
.progress-bar-inner {
  height: 100%;
  background: linear-gradient(90deg, #1bbf9f, #45f0c8);
  border-radius: 12px;
  transition: width 0.5s ease-in-out;
}
.progress-bar span {
  position: absolute;
  width: 100%;
  text-align: center;
  line-height: 24px;
  font-weight: bold;
  color: #0b1b2b;
  text-shadow: 0 0 2px rgba(255,255,255,0.5);
}

.island-status { margin-top: 12px; font-weight: bold; text-align: center; }
.island-status.cleared { color: #45f0c8; }

.dungeon-island.locked {
  opacity: 0.6;
  background: rgba(0,0,0,0.2);
  pointer-events: none; /* Disables clicks on locked islands */
}
.dungeon-island.locked:hover { transform: none; box-shadow: none; }
.dungeon-island.cleared { border-color: #45f0c8; }
